<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>SpringCloud微服务~面试题</title><meta name="description" content="May the Force be with you"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="1. SpringCloud常见组件有哪些？问题说明：这个题目主要考察对SpringCloud的组件基本了解
难易程度：简单
参考话术：
SpringCloud包含的组件很多，有很多功能是重复的。其中最常用组件包括：

注册中心组件：Eureka、Nacos等
负载均衡组件：Ribbon
远程调用组件：OpenFeign
网关组件：Zuul、GateWay
服务保护组件：Hystrix、Sentinel
服务配置管理组件：SpringCloudConfig、Nacos

2. Nacos的服务注册表结构是怎样的？​		什么叫做注册表结构啊，我们知道Naocs首先它是一个注册中心，我们所有的微服务在启动时，就会提交自己的信息到Nacos当中，我们Nacos保存当前服务的一些信息。那么保持在哪里呢？就是保存在这.."><script src="//unpkg.com/valine/dist/Valine.min.js"></script><meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Hexo & github" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Haojen's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">SpringCloud微服务~面试题</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-SpringCloud%E5%B8%B8%E8%A7%81%E7%BB%84%E4%BB%B6%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F"><span class="toc-text">1. SpringCloud常见组件有哪些？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-Nacos%E7%9A%84%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E8%A1%A8%E7%BB%93%E6%9E%84%E6%98%AF%E6%80%8E%E6%A0%B7%E7%9A%84%EF%BC%9F"><span class="toc-text">2. Nacos的服务注册表结构是怎样的？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-Nacos%E5%A6%82%E4%BD%95%E6%94%AF%E6%92%91%E6%95%B0%E5%8D%81%E4%B8%87%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E5%8E%8B%E5%8A%9B%EF%BC%9F"><span class="toc-text">3. Nacos如何支撑数十万服务注册压力？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-Nacos%E5%A6%82%E4%BD%95%E9%81%BF%E5%85%8D%E5%B9%B6%E5%8F%91%E8%AF%BB%E5%86%99%E5%86%B2%E7%AA%81%E9%97%AE%E9%A2%98%EF%BC%9F"><span class="toc-text">4. Nacos如何避免并发读写冲突问题？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-Nacos%E4%B8%8EEureka%E7%9A%84%E5%8C%BA%E5%88%AB%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F"><span class="toc-text">5. Nacos与Eureka的区别有哪些？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-Sentinel%E7%9A%84%E9%99%90%E6%B5%81%E4%B8%8EGateway%E7%9A%84%E9%99%90%E6%B5%81%E6%9C%89%E4%BB%80%E4%B9%88%E5%B7%AE%E5%88%AB%EF%BC%9F"><span class="toc-text">6. Sentinel的限流与Gateway的限流有什么差别？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-Sentinel%E7%9A%84%E7%BA%BF%E7%A8%8B%E9%9A%94%E7%A6%BB%E4%B8%8EHystix%E7%9A%84%E7%BA%BF%E7%A8%8B%E9%9A%94%E7%A6%BB%E6%9C%89%E4%BB%80%E4%B9%88%E5%B7%AE%E5%88%AB%EF%BC%9F"><span class="toc-text">7. Sentinel的线程隔离与Hystix的线程隔离有什么差别？</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1"><i class="tag post-item-tag">微服务</i></a><a href="/tags/%E9%9D%A2%E8%AF%95"><i class="tag post-item-tag">面试</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">SpringCloud微服务~面试题</h1><time class="has-text-grey" datetime="2023-02-09T16:41:13.825Z">2023-02-10</time><article class="mt-2 post-content"><h1 id="1-SpringCloud常见组件有哪些？"><a href="#1-SpringCloud常见组件有哪些？" class="headerlink" title="1. SpringCloud常见组件有哪些？"></a>1. SpringCloud常见组件有哪些？</h1><p><strong>问题说明：</strong>这个题目主要考察对SpringCloud的组件基本了解</p>
<p><strong>难易程度：</strong>简单</p>
<p><strong>参考话术：</strong></p>
<p>SpringCloud包含的组件很多，有很多功能是重复的。其中最常用组件包括：</p>
<ul>
<li>注册中心组件：Eureka、Nacos等</li>
<li>负载均衡组件：Ribbon</li>
<li>远程调用组件：OpenFeign</li>
<li>网关组件：Zuul、GateWay</li>
<li>服务保护组件：Hystrix、Sentinel</li>
<li>服务配置管理组件：SpringCloudConfig、Nacos</li>
</ul>
<h1 id="2-Nacos的服务注册表结构是怎样的？"><a href="#2-Nacos的服务注册表结构是怎样的？" class="headerlink" title="2. Nacos的服务注册表结构是怎样的？"></a>2. Nacos的服务注册表结构是怎样的？</h1><p>​		什么叫做注册表结构啊，我们知道Naocs首先它是一个注册中心，我们所有的微服务在启动时，就会提交自己的信息到Nacos当中，我们Nacos保存当前服务的一些信息。那么保持在哪里呢？就是保存在这个注册表当中，只有把所有的服务信息都保存下来了，将来消费者想要去获取服务时，才能够从这个注册表里得到对应服务的信息、IP端口才能进行访问。那么问题就来了，Nacos它是如何创建这样一个表，那么这个注册表结构是什么样子呢？面试官问这个问题其实就是考查两个东西，第一，就是你对于他的这个服务分级存储的一个模型是否了解，第二呢，就是Nacos的源码</p>
<p><img src="/../../images/image-20230210005624585.png" alt="image-20230210005624585"></p>
<p>Nacos采用了数据的分级存储模型，最外层是Namespace，用来隔离环境。然后是Group，用来对服务分组。接下来就是服务（Service）了，一个服务包含多个实例，但是可能处于不同机房，因此Service下有多个集群（Cluster），Cluster下是不同的实例（Instance）。</p>
<p>对应到Java代码中，Nacos采用了一个多层的Map来表示。结构为Map&lt;String, Map&lt;String, Service&gt;&gt;，其中最外层Map的key就是namespaceId，值是一个Map。内层Map的key是group拼接serviceName，值是Service对象。Service对象内部又是一个Map，key是集群名称，值是Cluster对象。而Cluster对象内部维护了Instance的集合。</p>
<h1 id="3-Nacos如何支撑数十万服务注册压力？"><a href="#3-Nacos如何支撑数十万服务注册压力？" class="headerlink" title="3. Nacos如何支撑数十万服务注册压力？"></a>3. Nacos如何支撑数十万服务注册压力？</h1><p>Nacos内部接收到注册的请求时，不会立即写数据，而是将服务注册的任务放入一个阻塞队列就立即响应给客户端。然后利用线程池读取阻塞队列中的任务，异步来完成实例更新，从而提高并发写能力。</p>
<h1 id="4-Nacos如何避免并发读写冲突问题？"><a href="#4-Nacos如何避免并发读写冲突问题？" class="headerlink" title="4. Nacos如何避免并发读写冲突问题？"></a>4. Nacos如何避免并发读写冲突问题？</h1><p>Nacos在更新实例列表时，会采用CopyOnWrite技术，首先将旧的实例列表拷贝一份，然后更新拷贝的实例列表，再用更新后的实例列表来覆盖旧的实例列表。</p>
<p>这样在更新的过程中，就不会对读实例列表的请求产生影响，也不会出现脏读问题了。</p>
<h1 id="5-Nacos与Eureka的区别有哪些？"><a href="#5-Nacos与Eureka的区别有哪些？" class="headerlink" title="5. Nacos与Eureka的区别有哪些？"></a>5. Nacos与Eureka的区别有哪些？</h1><p>Nacos与Eureka有相同点，也有不同之处，可以从以下几点来描述：</p>
<ul>
<li>接口方式：Nacos与Eureka都对外暴露了Rest风格的API接口，用来实现服务注册、发现等功能</li>
<li>实例类型：Nacos的实例有永久和临时实例之分；而Eureka只支持临时实例</li>
<li>健康检测：Nacos对临时实例采用心跳模式检测，对永久实例采用主动请求来检测；Eureka只支持心跳模式</li>
<li>服务发现：Nacos支持定时拉取和订阅推送两种模式；Eureka只支持定时拉取模式</li>
</ul>
<h1 id="6-Sentinel的限流与Gateway的限流有什么差别？"><a href="#6-Sentinel的限流与Gateway的限流有什么差别？" class="headerlink" title="6. Sentinel的限流与Gateway的限流有什么差别？"></a>6. Sentinel的限流与Gateway的限流有什么差别？</h1><p>考察对限流算法的掌握情况</p>
<p>限流算法常见的有三种实现：滑动时间窗口、令牌桶算法、漏桶算法。Gateway则采用了基于Redis实现的令牌桶算法。</p>
<p>而Sentinel内部却比较复杂：</p>
<ul>
<li>默认限流模式是基于滑动时间窗口算法</li>
<li>排队等待的限流模式则基于漏桶算法</li>
<li>而热点参数限流则是基于令牌桶算法</li>
</ul>
<h1 id="7-Sentinel的线程隔离与Hystix的线程隔离有什么差别？"><a href="#7-Sentinel的线程隔离与Hystix的线程隔离有什么差别？" class="headerlink" title="7. Sentinel的线程隔离与Hystix的线程隔离有什么差别？"></a>7. Sentinel的线程隔离与Hystix的线程隔离有什么差别？</h1><p>Hystix默认是基于线程池实现的线程隔离，每一个被隔离的业务都要创建一个独立的线程池，线程过多会带来额外的CPU开销，性能一般，但是隔离性更强。</p>
<p>Sentinel是基于信号量（计数器）实现的线程隔离，不用创建线程池，性能较好，但是隔离性一般。</p>
<p><img src="/../../images/image-20230210011501205.png" alt="image-20230210011501205"></p>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2023/02/15/%E9%9B%B6%E7%A2%8E%E7%9F%A5%E8%AF%86&amp;%E7%AC%94%E8%AE%B0/%E8%BF%90%E7%AE%97%E7%AC%A6/" title="运算符"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">上一页: 运算符</span></a><a class="button is-default" href="/2023/02/09/SpringCloud%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E8%BF%9C%E7%A8%8B%E8%B0%83%E7%94%A8/Feign/Feign%E7%9A%84%E4%BB%8B%E7%BB%8D%E5%92%8C%E4%BD%BF%E7%94%A8/" title="Feign的介绍和使用"><span class="has-text-weight-semibold">下一页: Feign的介绍和使用</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="Haojen/RunningYu" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article><article class="mt-6 comment-container" id="vcomments"></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><a title="twitter" target="_blank" rel="noopener nofollow" href="//twitter.com//"><i class="iconfont icon-twitter"></i></a><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/haojen"><i class="iconfont icon-github"></i></a><!-- Ins--><a title="instagram" target="_blank" rel="noopener nofollow" href="//www.instagram.com//"><i class="iconfont icon-ins"></i></a><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--><a title="facebook" target="_blank" rel="noopener nofollow" href="//www.facebook.com//"><i class="iconfont icon-tian7_facebook"></i></a></section><p><span>Copyright ©</span><span> Haojen 2023</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>